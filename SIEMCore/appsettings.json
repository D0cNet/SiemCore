{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "SiemCore": "Information"
    }
  },
  "AllowedHosts": "*",
  "Authentication": {
    "RequireHttps": true,
    "LogFailedAttempts": true,
    "ApiKeys": [
      {
        "Key": "siem-agent-prod-2024-a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6",
        "Description": "Production SIEM Agent - Primary",
        "Enabled": true,
        "ExpiresAt": null,
        "AllowedEndpoints": [
          "/api/siem/events",
          "/api/siem/agents/*/health",
          "/api/siem/agents/*/configuration"
        ],
        "AllowedIpRanges": [
          "192.168.1.0/24",
          "10.0.0.0/8",
          "172.16.0.0/12"
        ]
      },
      {
        "Key": "siem-agent-dev-2024-z9y8x7w6v5u4t3s2r1q0p9o8n7m6l5k4",
        "Description": "Development SIEM Agent",
        "Enabled": true,
        "ExpiresAt": "2025-12-31T23:59:59Z",
        "AllowedEndpoints": [
          "/api/siem/events",
          "/api/siem/agents/*/health",
          "/api/siem/agents/*/configuration"
        ],
        "AllowedIpRanges": [
          "127.0.0.1/32",
          "192.168.1.0/24"
        ]
      },
      {
        "Key": "siem-integration-test-f1e2d3c4b5a6978685746352413029",
        "Description": "Integration Testing Key",
        "Enabled": false,
        "ExpiresAt": "2024-12-31T23:59:59Z",
        "AllowedEndpoints": [
          "/api/siem/events"
        ],
        "AllowedIpRanges": [
          "127.0.0.1/32"
        ]
      }
    ],
    "ValidApiKeys": [
      "legacy-key-for-backward-compatibility-12345678901234567890"
    ]
  },
  "Siem": {
    "MaxEventsPerBatch": 1000,
    "MaxEventSize": 1048576,
    "EventRetentionDays": 90,
    "AlertRetentionDays": 365,
    "EnableEventValidation": true,
    "EnableThreatIntelligence": true,
    "EnableMachineLearning": true,
    "CorrelationRules": {
      "MaxActiveRules": 100,
      "DefaultTimeWindow": "00:10:00",
      "MaxEventsPerRule": 10000
    },
    "Performance": {
      "MaxConcurrentProcessing": 10,
      "EventProcessingTimeout": "00:00:30",
      "DatabaseConnectionTimeout": "00:00:15"
    }
  },
  "Database": {
    "ConnectionString": "Data Source=siem_core.db;Cache=Shared",
    "CommandTimeout": 30,
    "EnableSensitiveDataLogging": false
  },
  "ThreatIntelligence": {
    "EnableVirusTotalLookup": false,
    "EnableAbuseIPDBLookup": false,
    "CacheExpirationHours": 24,
    "MaxConcurrentLookups": 5,
    "ApiKeys": {
      "VirusTotal": "",
      "AbuseIPDB": ""
    }
  },
  "MachineLearning": {
    "EnableAnomalyDetection": true,
    "ModelUpdateIntervalHours": 24,
    "MinEventsForTraining": 1000,
    "AnomalyThreshold": 0.8
  },
  "Notifications": {
    "EnableEmailNotifications": false,
    "EnableSlackNotifications": false,
    "EnableWebhookNotifications": false,
    "Email": {
      "SmtpServer": "",
      "SmtpPort": 587,
      "Username": "",
      "Password": "",
      "FromAddress": "siem@company.com",
      "ToAddresses": [
        "security-team@company.com"
      ]
    },
    "Slack": {
      "WebhookUrl": "",
      "Channel": "#security-alerts",
      "Username": "SIEM Bot"
    },
    "Webhook": {
      "Url": "",
      "Secret": "",
      "Timeout": 30
    }
  },
  "Cors": {
    "AllowedOrigins": [
      "https://localhost:3000",
      "https://siem-dashboard.company.com"
    ],
    "AllowedMethods": [
      "GET",
      "POST",
      "PUT",
      "DELETE"
    ],
    "AllowedHeaders": [
      "Content-Type",
      "Authorization",
      "X-Agent-Id",
      "X-Agent-Version"
    ]
  }
}
